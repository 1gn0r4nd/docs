"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[9096],{40661:function(e,t,i){i.r(t),i.d(t,{contentTitle:function(){return r},default:function(){return m},frontMatter:function(){return l},metadata:function(){return c},toc:function(){return u}});var n=i(83117),o=i(80102),d=(i(67294),i(3905)),a=i(31736),s=["components"],l={id:"full-did-delete",title:"Delete a Full DID"},r=void 0,c={unversionedId:"develop/sdk/cookbook/dids/full-did-delete",id:"develop/sdk/cookbook/dids/full-did-delete",title:"Delete a Full DID",description:"Once not needed anymore, it is recommended to remove the DID details from the KILT blockchain.",source:"@site/docs/develop/01_sdk/02_cookbook/01_dids/06_full_did_delete.md",sourceDirName:"develop/01_sdk/02_cookbook/01_dids",slug:"/develop/sdk/cookbook/dids/full-did-delete",permalink:"/docs/develop/sdk/cookbook/dids/full-did-delete",editUrl:"https://github.com/KILTprotocol/docs/edit/master/docs/develop/01_sdk/02_cookbook/01_dids/06_full_did_delete.md",tags:[],version:"current",sidebarPosition:6,frontMatter:{id:"full-did-delete",title:"Delete a Full DID"},sidebar:"sdk",previous:{title:"Generate and Verify a DID Signature",permalink:"/docs/develop/sdk/cookbook/dids/did-signature"},next:{title:"Claim a web3name",permalink:"/docs/develop/sdk/cookbook/web3names/web3name-claim"}},u=[{value:"Claim back a DID deposit",id:"claim-back-a-did-deposit",children:[],level:2}],p={toc:u};function m(e){var t=e.components,i=(0,o.Z)(e,s);return(0,d.kt)("wrapper",(0,n.Z)({},p,i,{components:t,mdxType:"MDXLayout"}),(0,d.kt)("p",null,"Once not needed anymore, it is recommended to remove the DID details from the KILT blockchain.\nThe following snippet shows how to do it:"),(0,d.kt)(a.Z,{className:"language-ts",mdxType:"CodeBlock"},"import type { KeyringPair } from '@polkadot/keyring/types'\n\nimport * as Kilt from '@kiltprotocol/sdk-js'\n\nexport async function deleteFullDid(\n  keystore: Kilt.Did.DemoKeystore,\n  submitterAccount: KeyringPair,\n  fullDid: Kilt.Did.FullDidDetails,\n  resolveOn: Kilt.SubscriptionPromise.ResultEvaluator = Kilt.BlockchainUtils\n    .IS_FINALIZED\n): Promise<void> {\n  // Create a DID deletion operation. We specify the number of endpoints currently stored under the DID because\n  // of the upper computation limit required by the blockchain runtime.\n  const endpointsCountForDid = await Kilt.Did.DidChain.queryEndpointsCounts(\n    fullDid.identifier\n  )\n  const didDeletionExtrinsic = await Kilt.Did.DidChain.getDeleteDidExtrinsic(\n    endpointsCountForDid\n  )\n\n  // Sign the DID deletion operation using the DID authentication key.\n  // This results in an unsigned extrinsic that can be then signed and submitted to the KILT blockchain by the account\n  // authorized in this operation, Alice in this case.\n  const didSignedDeletionExtrinsic = await fullDid.authorizeExtrinsic(\n    didDeletionExtrinsic,\n    keystore,\n    submitterAccount.address\n  )\n\n  await Kilt.BlockchainUtils.signAndSubmitTx(\n    didSignedDeletionExtrinsic,\n    submitterAccount,\n    {\n      resolveOn\n    }\n  )\n}\n"),(0,d.kt)("div",{className:"admonition admonition-warning alert alert--danger"},(0,d.kt)("div",{parentName:"div",className:"admonition-heading"},(0,d.kt)("h5",{parentName:"div"},(0,d.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,d.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,d.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"warning")),(0,d.kt)("div",{parentName:"div",className:"admonition-content"},(0,d.kt)("p",{parentName:"div"},"Please note that once deleted, a full DID becomes unusable and cannot be created anymore, meaning that all Credentials obtained with that DID must be re-obtained with a different one if needed."))),(0,d.kt)("h2",{id:"claim-back-a-did-deposit"},"Claim back a DID deposit"),(0,d.kt)("p",null,"Claiming back the deposit of a DID is semantically equivalent to deleting the DID, with the difference that the extrinsic to claim the deposit can only be called by the deposit owner and does not require any interaction with the DID subject:"),(0,d.kt)(a.Z,{className:"language-ts",mdxType:"CodeBlock"},"import type { KeyringPair } from '@polkadot/keyring/types'\n\nimport * as Kilt from '@kiltprotocol/sdk-js'\n\nexport async function reclaimFullDidDeposit(\n  depositPayerAccount: KeyringPair,\n  didIdentifier: Kilt.IDidIdentifier,\n  resolveOn: Kilt.SubscriptionPromise.ResultEvaluator = Kilt.BlockchainUtils\n    .IS_FINALIZED\n): Promise<void> {\n  // Generate the submittable extrinsic to claim the deposit back.\n  // It includes the DID identifier for which the deposit needs to be returned\n  // and the count of service endpoints to provide an upper bound to the computation of the extrinsic execution.\n  const endpointsCountForDid = await Kilt.Did.DidChain.queryEndpointsCounts(\n    didIdentifier\n  )\n  const depositClaimExtrinsic =\n    await Kilt.Did.DidChain.getReclaimDepositExtrinsic(\n      didIdentifier,\n      endpointsCountForDid\n    )\n\n  // The submission will fail if `depositPayerAccount` is not the owner of the deposit associated with the given DID identifier.\n  await Kilt.BlockchainUtils.signAndSubmitTx(\n    depositClaimExtrinsic,\n    depositPayerAccount,\n    {\n      resolveOn\n    }\n  )\n}\n"))}m.isMDXComponent=!0}}]);