"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[2417],{75917:function(e,n,t){t.r(n),t.d(n,{assets:function(){return c},contentTitle:function(){return l},default:function(){return u},frontMatter:function(){return a},metadata:function(){return s},toc:function(){return d}});var i=t(83117),o=(t(67294),t(3905)),r=t(90814);const a={id:"did",title:"DID"},l=void 0,s={unversionedId:"develop/workshop/claimer/did",id:"develop/workshop/claimer/did",title:"DID",description:"Time to make a light DID using the previously created account for the Claimer.",source:"@site/docs/develop/03_workshop/05_claimer/01_did.md",sourceDirName:"develop/03_workshop/05_claimer",slug:"/develop/workshop/claimer/did",permalink:"/docs/develop/workshop/claimer/did",draft:!1,editUrl:"https://github.com/KILTprotocol/docs/edit/master/docs/develop/03_workshop/05_claimer/01_did.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{id:"did",title:"DID"},sidebar:"workshop",previous:{title:"\ud83d\udc64 Claimer",permalink:"/docs/develop/workshop/claimer/"},next:{title:"Request an Attestation",permalink:"/docs/develop/workshop/claimer/request"}},c={},d=[{value:"Generate Keys",id:"generate-keys",level:2},{value:"Generate Light DID",id:"generate-light-did",level:2},{value:"Run",id:"run",level:2}],p={toc:d};function u(e){let{components:n,...t}=e;return(0,o.kt)("wrapper",(0,i.Z)({},p,t,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"Time to make a light DID using the previously created account for the ",(0,o.kt)("span",{className:"label-role claimer"},"Claimer"),".\nSince a light DID is not registered on the blockchain, you don't need funds for creating one.\nRemember light DIDs can:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Sign claims and attestations with the authentication keys"),(0,o.kt)("li",{parentName:"ul"},"Encrypting messages with the encryption keys")),(0,o.kt)("p",null,"Take a look at our ",(0,o.kt)("a",{parentName:"p",href:"/docs/develop/sdk/cookbook/dids/light-did-creation"},"DID documentation")," if you want to learn more about DIDs and the difference between their light and full versions."),(0,o.kt)("h2",{id:"generate-keys"},"Generate Keys"),(0,o.kt)("p",null,"Similar to the Attester, the Claimer must set up the DID keys.\nCreate a file ",(0,o.kt)("inlineCode",{parentName:"p"},"claimer/generateKeypairs.ts")," and copy the code below."),(0,o.kt)(r.Z,{className:"language-ts",title:"claimer/generateKeypairs.ts",mdxType:"CodeBlock"},"import * as Kilt from '@kiltprotocol/sdk-js'\n\nexport async function generateKeypairs(\n  keystore: Kilt.Did.DemoKeystore,\n  mnemonic?: string\n): Promise<{\n  authenticationKey: Kilt.NewDidVerificationKey\n  encryptionKey: Kilt.NewDidEncryptionKey\n}> {\n  // signing keypair\n  const signing = await keystore.generateKeypair({\n    alg: Kilt.Did.SigningAlgorithms.Sr25519,\n    seed: mnemonic\n  })\n\n  // encryption keypair\n  const encryption = await keystore.generateKeypair({\n    alg: Kilt.Did.EncryptionAlgorithms.NaclBox,\n    seed: mnemonic\n  })\n\n  // build the keys object\n  return {\n    authenticationKey: {\n      publicKey: signing.publicKey,\n      type: Kilt.VerificationKeyType.Sr25519\n    },\n    encryptionKey: {\n      publicKey: encryption.publicKey,\n      type: Kilt.EncryptionKeyType.X25519\n    }\n  }\n}\n"),(0,o.kt)("p",null,"The Claimer only needs an authentication key and an encryption key.\nHere the keys are both derived from the same seed, but they could also have two different seeds."),(0,o.kt)("h2",{id:"generate-light-did"},"Generate Light DID"),(0,o.kt)("p",null,"Once our ",(0,o.kt)("inlineCode",{parentName:"p"},"keypairs")," are generated we can create our light DID.\nBecause it's off-chain we can just create the DID object every time, we don't need to resolve them before using it.\nBut we'll still accept ",(0,o.kt)("inlineCode",{parentName:"p"},"didUri")," and prompt to save it in ",(0,o.kt)("inlineCode",{parentName:"p"},".env")," for our reference."),(0,o.kt)(r.Z,{className:"language-ts",title:"claimer/generateLightDid.ts",mdxType:"CodeBlock"},"import { config as envConfig } from 'dotenv'\n\nimport { mnemonicGenerate } from '@polkadot/util-crypto'\n\nimport * as Kilt from '@kiltprotocol/sdk-js'\n\nimport { generateKeypairs } from './generateKeypairs'\n\nexport async function generateLightDid(): Promise<{\n  lightDid: Kilt.Did.LightDidDetails\n  mnemonic: string\n}> {\n  // init\n  await Kilt.init({ address: process.env.WSS_ADDRESS })\n\n  // create secret and DID public keys\n  const keystore = new Kilt.Did.DemoKeystore()\n  const mnemonic = mnemonicGenerate()\n  const keys = await generateKeypairs(keystore, mnemonic)\n\n  // create the DID\n  const lightDid = Kilt.Did.LightDidDetails.fromDetails({\n    ...keys,\n    authenticationKey: {\n      publicKey: keys.authenticationKey.publicKey,\n      type: Kilt.VerificationKeyType.Sr25519\n    }\n  })\n\n  return {\n    lightDid,\n    mnemonic\n  }\n}\n\n// don't execute if this is imported by another file\nif (require.main === module) {\n  envConfig()\n  generateLightDid()\n    .catch((e) => {\n      console.log('Error while setting up claimer DID', e)\n      process.exit(1)\n    })\n    .then(({ lightDid, mnemonic }) => {\n      console.log('\\nsave following to .env to continue\\n')\n      console.log(`CLAIMER_MNEMONIC=\"${mnemonic}\"`)\n      console.log(`CLAIMER_DID_URI=\"${lightDid.uri}\"`)\n    })\n}\n"),(0,o.kt)("p",null,"After everything is initialized, we create a mnemonic that will be used to create the light DID.\nAs you may have noticed the Claimer doesn't have an ",(0,o.kt)("inlineCode",{parentName:"p"},"account"),".\nThe Claimer doesn't need to hold funds and also doesn't need a blockchain account."),(0,o.kt)("h2",{id:"run"},"Run"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"yarn ts-node ./claimer/generateLightDid.ts\n")),(0,o.kt)("p",null,"Your output will provide you with ",(0,o.kt)("inlineCode",{parentName:"p"},"CLAIMER_MNEMONIC")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"CLAIMER_DID_URI"),".\nBe sure to save it in your ",(0,o.kt)("inlineCode",{parentName:"p"},".env")," file, it should now look similar to this."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-env",metastring:'title=".env"',title:'".env"'},'WSS_ADDRESS=wss://peregrine.kilt.io/parachain-public-ws\n\nATTESTER_MNEMONIC="warrior icon use cry...\nATTESTER_ADDRESS=4ohMvUHsyeDhMVZF...\nATTESTER_DID_URI=did:kilt:4ohMvUHsyeDhMVZF...\n\nCLAIMER_MNEMONIC="danger awkward wrestle snap...\nCLAIMER_DID_URI=did:kilt:light:004tTDugL...\n')),(0,o.kt)("p",null,"Well done - You've successfully generated a light DID!"))}u.isMDXComponent=!0}}]);